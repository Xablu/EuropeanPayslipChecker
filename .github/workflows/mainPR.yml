on: 
  workflow_dispatch:
  pull_request:
    branches:
      - main
name: Dotnet build, Sonarscanner and PR decoration
jobs:
  sonarscanner-pr-decoration:
    runs-on: ubuntu-latest
    name: Dotnet build, Sonarscanner and PR decoration
    steps:
      - uses: actions/checkout@v2
      - uses: ThijsvDorp/github-pr-decoration-action@main
        name: Dotnet build and SonarScanner for .NET 5 with pull request decoration support
        with:
          # The key of the SonarQube project
          sonarProjectKey: EuropeanPayslipChecker
          # The name of the SonarQube project
          sonarProjectName:  "EuropeanPayslipChecker"
          # The SonarQube server URL. For SonarCloud, skip this setting.
          sonarHostname:  https://codequality.xablu.com
          # Pass github event pull_request head sha
          sonarBeginArguments: -Dsonar.scm.revision=${{ github.event.pull_request.head.sha }}
          # Enable or disable Sonarscan (true=enable, false=disable)
          sonarEnableScan: true
          # Get sonartoken
          sonarToken: ${{ secrets.SONARQUBE_TOKEN }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
